h4 LOAN RECEIPT FORM 
h5 Student Textbooks 

ul#grade-options.dropdown-content
  - GradeLevel.all.each do |grade|
    li 
      = link_to grade.name, "#!", onclick:"filterSectionOptions(#{grade.id}, #{grade.name});"
ul#section-options.dropdown-content
  - @grade_sections.each do |section|
    li
      = link_to section.name, "#!", class:"grade-#{section.grade_level_id}", onclick:"filterStudentOptions(#{section.id}, '#{section.name}');"
ul#student-options.dropdown-content
  - if @labels.present?
    - @labels.each do |label|
      li
        = link_to label.name, receipt_form_student_books_path(l:label.id)
      

javascript:
  function filterSectionOptions(id, name) {
    var grade_ids = #{raw @grade_level_ids};
    $("#grade").html("Grade "+name);
    grade_ids.forEach(function(g){ 
      if(id!=g) { 
        $(".grade-"+g).hide();
      } else {
        $(".grade-"+id).show();
      }
    }) 
  }
  function filterStudentOptions(id, name) {
    $("#section").html("Section "+name);
    $.getJSON("/book_labels.json?term="+name, null, function (data) {
      console.log("Parsing /book_labels.json?term="+name);
      var list = "<li><a href='/student_books/receipt_form?gs="+name+"'>All</a></li>";
      $.each(data, function(i,item){
          list += "<li><a href='/student_books/receipt_form?g="+item.grade_level_id+";l="+item.id+"'>"+item.label+"</a></li>";
      });
      $("#student-options").html(list);
    });
  }

nav
  .nav-wrapper
    ul
      li 
        = link_to 'PDF Format', receipt_form_student_books_path(l:params[:l], format: :pdf), target: '_blank'
      li.right
        a#student-menu.dropdown-button href="#!" data-activates="student-options"
          span#student = params[:l].present? ? "#{@book_labels.first.name}" : 'Choose number'
          i.material-icons.right arrow_drop_down
      li.right
        a.dropdown-button href="#!" data-activates="section-options"
          span#section = params[:l].present? ? "Section #{@grade_section_name}" : 'Choose section'
          i.material-icons.right arrow_drop_down
      li.right
        a.dropdown-button href="#!" data-activates="grade-options"
          span#grade = params[:l].present? ? "Grade #{@grade_level_name}" : 'Choose grade'
          i.material-icons.right arrow_drop_down

- if @book_labels.present?
  - @book_labels.each do |book_label|
    h4 = book_label.name
    = render partial: 'receipt_form_table', locals: {book_label: book_label}
    .page-break
